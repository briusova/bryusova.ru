import{defineComponent as y,ref as k,computed as i,watch as P,onUnmounted as B,createElementBlock as M,openBlock as h,Fragment as C,renderList as O,normalizeClass as j,createBlock as $,resolveDynamicComponent as z}from"vue";import{t as c,v as E,p as g,m as D,u as F,a as L,r as R,b as T,c as U,s as X,d as Y,_ as q}from"./index-DZp-kO1Q.js";import{useRouter as A}from"vue-router";import"./sucrase-DTaNgZ3p.js";import"./compiler-sfc-CHbDt8t7.js";const G=y({__name:"PageView",setup(S,{expose:w}){w();const f=k([]),t=A(),p=i(()=>c.value?.siblings??[]),n=[],o=i(()=>p.value.filter(({enabled:e})=>e)),u=()=>{n.forEach(e=>{e()}),n.length=0},d=i(()=>c.value===void 0||c.value.parent?.flat?o.value:[c.value]),l=i(()=>new Map(d.value.map(({id:e=E()})=>[e,!1]))),m=k(new Map(l.value)),V=i(()=>{const[[e,s]=[]]=g;return g.clear(),e&&s&&g.set(e,s),Object.fromEntries(d.value.map(r=>[r.id,D(r)]))});P(f,e=>{u(),setTimeout(()=>{e.forEach(s=>{const{stop:r}=F(s,([{isIntersecting:a,target:{id:v}={}}={}]=[])=>{m.value=new Map(l.value),v&&a!==void 0&&l.value.set(v,a)},{threshold:.1});n.push(r)})})},{deep:!0}),L(window,{behavior:"smooth",onStop:()=>{if(!T.value){const{scrollX:e,scrollY:s}=window,[r]=d.value,[a]=U.value;if(a&&r){const{$children:[{id:v}={}]=[]}=a,x=!Math.floor(e)&&!Math.floor(s)&&r.id===v?a.id:[...l.value.entries()].find(([,_])=>_)?.[0]??[...m.value.entries()].find(([,_])=>_)?.[0]??r.id;X.value=!1,t.push({name:x}).catch(Y)}}}}),B(u);const b={refs:f,router:t,siblings:p,stops:n,$siblings:o,clearStops:u,these:d,intersecting:l,$intersecting:m,templates:V,get v4(){return E},get resolve(){return R},get that(){return c}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),H=["id","role"];function I(S,w,f,t,p,n){return h(!0),M(C,null,O(t.these,o=>(h(),M("div",{id:o.id??t.v4(),key:o.id??t.v4(),ref_for:!0,ref:"refs",class:j(o.class),role:o.id===t.that?.id?"main":"section","un-cloak":""},[(h(),$(z(t.templates[o.id]),{id:o.id,"un-cloak":"",onVnodeMounted:u=>t.resolve(o)},null,8,["id","onVnodeMounted"]))],10,H))),128)}const Z=q(G,[["render",I],["__file","PageView.vue"]]);export{Z as default};
